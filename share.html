<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>内容分享</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    .media { margin: 20px 0; }
    button { margin-top: 10px; }
  </style>
  <script>
    function getQueryParam(name) {
      const url = window.location.search;
      const params = new URLSearchParams(url);
      return params.get(name);
    }
    function b64DecodeUnicode(str) {
      try {
        return decodeURIComponent(escape(window.atob(str)));
      } catch (e) {
        return '';
      }
    }
    window.onload = function() {
      const dataB64 = getQueryParam('data');
      if (!dataB64) {
        document.getElementById('content').innerText = '无效的分享链接';
        return;
      }
      let data;
      try {
        data = JSON.parse(b64DecodeUnicode(dataB64));
      } catch (e) {
        document.getElementById('content').innerText = '数据解析失败';
        return;
      }
      document.getElementById('title').innerText = data.title || '';
      // 展示图片
      if (data.img_url) {
        document.getElementById('img_block').innerHTML =
          `<img src="${data.img_url}" style="max-width:90vw;" alt="图片"><br>` +
          `<a href="${data.img_url}" download><button>下载图片</button></a>` +
          `<p>长按图片可保存到相册</p>`;
      }
      // 展示视频
      if (data.video_url) {
        document.getElementById('video_block').innerHTML =
          `<video src="${data.video_url}" controls style="max-width:90vw;"></video><br>` +
          `<a href="${data.video_url}" download><button>下载视频</button></a>` +
          `<p>长按视频可保存到相册（部分浏览器支持）</p>`;
      }
    }
  </script>
</head>
<body>
  <h2>内容分享</h2>
  <div id="content">
    <p>标题：<span id="title"></span></p>
    <div class="media" id="img_block"></div>
    <div class="media" id="video_block"></div>
  </div>
</body>
</html> 